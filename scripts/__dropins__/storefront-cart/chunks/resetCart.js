import{FetchGraphQL as i}from"@dropins/tools/fetch-graphql.js";import"@dropins/tools/event-bus.js";function c(t){const r=document.cookie.split(";");for(let s=0;s<r.length;s++){const a=r[s].trim();if(a.indexOf(`${t}=`)===0)return a.substring(t.length+1)}return null}function h(t){t?sessionStorage.setItem("DROPIN__CART__CART__DATA",JSON.stringify(t)):sessionStorage.removeItem("DROPIN__CART__CART__DATA")}function _(){const t=sessionStorage.getItem("DROPIN__CART__CART__DATA");return t?JSON.parse(t):null}function I(t){t?sessionStorage.setItem("DROPIN__CART__SHIPPING__DATA",JSON.stringify(t)):sessionStorage.removeItem("DROPIN__CART__SHIPPING__DATA")}const u=(()=>{const t=_();return{cartId:null,authenticated:t?!t.isGuestCart:!1}})(),n=new Proxy(u,{set(t,r,s){var a;if(t[r]=s,r==="cartId"){if(s===n.cartId)return!0;if(s===null)return document.cookie="DROPIN__CART__CART-ID=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",!0;const e=(a=n.config)==null?void 0:a.cartExpiresInDays;e||console.warn('Missing "expiresInDays" config. Cookie expiration will default to 30 days.');const o=new Date;o.setDate(o.getDate()+(e??30)),document.cookie=`DROPIN__CART__CART-ID=${s}; expires=${o.toUTCString()}; path=/`}return!0},get(t,r){return r==="cartId"?c("DROPIN__CART__CART-ID"):t[r]}}),{setEndpoint:f,setFetchGraphQlHeader:p,removeFetchGraphQlHeader:A,setFetchGraphQlHeaders:C,fetchGraphQl:D,getConfig:R}=new i().getMethods(),T=t=>{const r=t.findIndex(({extensions:e})=>(e==null?void 0:e.category)==="graphql-authorization")>-1,s=t.findIndex(({extensions:e})=>(e==null?void 0:e.category)==="graphql-no-such-entity")>-1,a=t.map(e=>e.message).join(" ");if(r||s)return l(),console.error(a),null;throw Error(a)},l=()=>(n.cartId=null,n.authenticated=!1,Promise.resolve(null));export{I as a,f as b,p as c,C as d,R as e,D as f,_ as g,T as h,l as i,h as j,A as r,n as s};
